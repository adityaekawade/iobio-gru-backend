Bootstrap: library
From: ubuntu:16.04 

%post
    HTSLIB_VERSION=1.9

    # update & build environ
    apt-get update
    apt-get install -y git wget build-essential zlib1g-dev libbz2-dev liblzma-dev libcurl4-openssl-dev libssl-dev libgsl-dev
    
    # get tool & YQ htslib wrapper
    mkdir -p /build
    cd /build
    git clone --recurse-submodules https://github.com/stefinfection/gtenricher.git
    cd gtenricher/contrib 
    
    # get htslib & build
    wget -q https://github.com/samtools/htslib/releases/download/${HTSLIB_VERSION}/htslib-${HTSLIB_VERSION}.tar.bz2
    tar -xjf htslib-${HTSLIB_VERSION}.tar.bz2 
    cd htslib-${HTSLIB_VERSION}
    make
 
    # build
    cd ../..
    ./configure --with-htslib=./contrib/htslib-${HTSLIB_VERSION}
    make

    # put tool in path & slim down
    strip gtenricher
    cp gtenricher /usr/bin/
    
%runscript
    /usr/bin/gtEnricher $@
